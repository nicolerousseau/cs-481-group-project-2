import java.io.*;
import java.net.*;
import java.util.Scanner;

public class Server 
{
 public static void main(String[] args)
	{
		try{
			Scanner scan = new Scanner(System.in);
			System.out.print("Port: ");
			int port = scan.nextInt();
			
			ServerSocket sock =null;
		
			sock = new ServerSocket(port);
	
		
			Socket client = null;   
			//wait for client, when client connection established, a new socket object is created
			client = sock.accept(); 
	
			Thread listen = new Thread(new ThreadSocket(client));
			listen.start();
	
			PrintWriter out = new PrintWriter(client.getOutputStream(), true);
			//write to socket
			
			BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); 
			//read from socket
	
	
			while (true)   //read from socket
			{out.println(in.readLine());         //send message back to the client
		    if (in.readLine().equals("stop"))            //end loop
		       break;  }
			
			
			scan.close();                       //close scan
			in.close();                           //close streams
			out.close();	
			sock.close();                      //close sockets
			client.close();
		}catch  (IOException e) {System.out.println(e);}        

	}	

}

